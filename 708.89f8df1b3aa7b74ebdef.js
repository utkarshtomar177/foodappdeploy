"use strict";(self.webpackChunk_dashboard=self.webpackChunk_dashboard||[]).push([[708],{4708:(xe,Z,n)=>{n.r(Z),n.d(Z,{OrdersModule:()=>he});var T=n(3423),O=n(1095),q=n(7539),p=n(8295),A=n(6627),C=n(9983),D=n(3935),x=n(9692),b=n(2178),I=n(2458),m=n(1494),y=n(7441),Q=n(5396),N=n(1436),L=n(4466),a=n(3679),k=n(9765),F=n(6682),u=n(6782),w=n(4395),c=n(3190),f=n(8002),S=n(1452),e=n(7716),R=n(1400),v=n(6215),B=n(205),Y=n(5917),U=n(3342),_=n(5257),M=n(5435),j=n(1841);let J=(()=>{class r{constructor(t){this._httpClient=t,this._orders=new v.X(null),this._order=new v.X(null),this._pagination=new v.X(null)}get orders$(){return this._orders.asObservable()}get order$(){return this._order.asObservable()}get pagination$(){return this._pagination.asObservable()}getOrders(t=0,o=10,s="pickupAddress",l="asc",d=""){return this._httpClient.get("http://13.51.195.30:8080/admin/donations",{params:{page:""+t,size:""+o,sort:s,order:l,search:d}}).pipe((0,U.b)(h=>{this._pagination.next(h.pagination),this._orders.next(h.donations)}))}getOrderById(t){return this.orders$.pipe((0,_.q)(1),(0,f.U)(o=>{const s=o.find(l=>l.id===t)||null;return this._order.next(s),s}),(0,c.w)(o=>o?(0,Y.of)(o):(0,B._)("Could not find order with id of "+t+"!")))}updateOrder(t,o){return this.orders$.pipe((0,_.q)(1),(0,c.w)(s=>this._httpClient.patch("http://13.51.195.30:8080/admin/donation/"+t,{id:t,volunteerID:o}).pipe((0,f.U)(l=>{const d=s.findIndex(h=>h.id===t);return s[d]=l,this._orders.next(s),l}),(0,c.w)(l=>this.order$.pipe((0,_.q)(1),(0,M.h)(d=>d&&d.id===t),(0,U.b)(()=>(this._order.next(l),l)))))))}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(j.eN))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var $=n(9150),g=n(8583);function z(r,i){1&r&&(e.TgZ(0,"div",13),e._UZ(1,"mat-progress-bar",14),e.qZA()),2&r&&(e.xp6(1),e.Q6J("mode","indeterminate"))}function V(r,i){if(1&r&&(e.ynx(0),e.TgZ(1,"div",26),e._uU(2),e.qZA(),e.BQk()),2&r){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.volunteer.name," ")}}function E(r,i){1&r&&(e.ynx(0),e.TgZ(1,"div",26),e._uU(2," - "),e.qZA(),e.BQk())}function G(r,i){1&r&&(e.ynx(0),e._UZ(1,"mat-icon",30),e.BQk()),2&r&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function X(r,i){1&r&&(e.ynx(0),e._UZ(1,"mat-icon",31),e.BQk()),2&r&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}function H(r,i){1&r&&e.GkF(0)}const W=function(r){return{$implicit:r}};function P(r,i){if(1&r&&(e.ynx(0),e.YNc(1,H,1,0,"ng-container",32),e.BQk()),2&r){const t=e.oxw(5),o=e.MAs(14);e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(2,W,t.selectedOrder))}}function K(r,i){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",23),e.TgZ(2,"div",24),e._uU(3),e.qZA(),e.TgZ(4,"div",25),e.TgZ(5,"div",24),e._uU(6),e.qZA(),e.qZA(),e.TgZ(7,"div",26),e._uU(8),e.qZA(),e.TgZ(9,"div",26),e._uU(10),e.qZA(),e.YNc(11,V,3,1,"ng-container",10),e.YNc(12,E,3,0,"ng-container",10),e.TgZ(13,"div",26),e._uU(14),e.qZA(),e.TgZ(15,"div",27),e.YNc(16,G,2,1,"ng-container",10),e.YNc(17,X,2,1,"ng-container",10),e.qZA(),e.TgZ(18,"div"),e.TgZ(19,"button",28),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw(4).toggleDetails(l.id)}),e._UZ(20,"mat-icon",29),e.qZA(),e.qZA(),e.qZA(),e.TgZ(21,"div",16),e.YNc(22,P,2,4,"ng-container",10),e.qZA(),e.BQk()}if(2&r){const t=i.$implicit,o=i.index,s=e.oxw(4);e.xp6(3),e.hij(" ",o+1," "),e.xp6(3),e.Oqu(t.donor.name),e.xp6(2),e.hij(" ",t.donor.phone," "),e.xp6(2),e.hij(" ",t.pickupAddress," "),e.xp6(1),e.Q6J("ngIf",t.volunteer),e.xp6(1),e.Q6J("ngIf",!t.volunteer),e.xp6(2),e.hij(" ",t.donationDate," "),e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(3),e.Q6J("svgIcon",(null==s.selectedOrder?null:s.selectedOrder.id)===t.id?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down"),e.xp6(2),e.Q6J("ngIf",(null==s.selectedOrder?null:s.selectedOrder.id)===t.id)}}function ee(r,i){if(1&r&&(e.ynx(0),e.YNc(1,K,23,11,"ng-container",22),e.BQk()),2&r){const t=i.ngIf,o=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",o.trackByFn)}}const te=function(r){return{"pointer-events-none":r}},re=function(){return[5,10,25,100]};function ne(r,i){if(1&r&&(e.ynx(0),e.TgZ(1,"div",16),e.TgZ(2,"div",17),e.TgZ(3,"div",18),e._uU(4," S. No. "),e.qZA(),e.TgZ(5,"div",18),e._uU(6," Donor Name "),e.qZA(),e.TgZ(7,"div",19),e._uU(8," Contact "),e.qZA(),e.TgZ(9,"div",19),e._uU(10," Address "),e.qZA(),e.TgZ(11,"div",19),e._uU(12," Volunteer "),e.qZA(),e.TgZ(13,"div",19),e._uU(14," Scheduled Date "),e.qZA(),e.TgZ(15,"div",19),e._uU(16," Active "),e.qZA(),e.TgZ(17,"div",20),e._uU(18,"Details"),e.qZA(),e.qZA(),e.YNc(19,ee,2,2,"ng-container",10),e.ALo(20,"async"),e.qZA(),e._UZ(21,"mat-paginator",21),e.BQk()),2&r){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","serial_number"),e.xp6(2),e.Q6J("mat-sort-header","donor.name"),e.xp6(2),e.Q6J("mat-sort-header","donor.phone"),e.xp6(2),e.Q6J("mat-sort-header","pickupAddress"),e.xp6(2),e.Q6J("mat-sort-header","volunteer.name"),e.xp6(2),e.Q6J("mat-sort-header","donationDate"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(20,14,t.orders$)),e.xp6(2),e.Q6J("ngClass",e.VKq(16,te,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(18,re))("showFirstLastButtons",!0)}}function oe(r,i){if(1&r&&(e.ynx(0),e.YNc(1,ne,22,19,"ng-container",15),e.BQk()),2&r){const t=i.ngIf;e.oxw();const o=e.MAs(16);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",o)}}function ie(r,i){if(1&r&&(e.ynx(0),e.TgZ(1,"mat-option",56),e._uU(2),e.qZA(),e.BQk()),2&r){const t=i.$implicit;e.xp6(1),e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.name," ")}}function se(r,i){1&r&&(e.ynx(0),e._UZ(1,"mat-icon",58),e.TgZ(2,"span",59),e._uU(3,"Donation Data updated"),e.qZA(),e.BQk()),2&r&&(e.xp6(1),e.Q6J("svgIcon","heroicons_outline:check"))}function ae(r,i){1&r&&(e.ynx(0),e._UZ(1,"mat-icon",60),e.TgZ(2,"span",59),e._uU(3,"An error occurred, try again!"),e.qZA(),e.BQk()),2&r&&(e.xp6(1),e.Q6J("svgIcon","heroicons_outline:x"))}function le(r,i){if(1&r&&(e.TgZ(0,"div",57),e.YNc(1,se,4,1,"ng-container",10),e.YNc(2,ae,4,1,"ng-container",10),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf","success"===t.flashMessage),e.xp6(1),e.Q6J("ngIf","error"===t.flashMessage)}}function de(r,i){if(1&r){const t=e.EpF();e.TgZ(0,"div",33),e.TgZ(1,"div",34),e.TgZ(2,"form",35),e.TgZ(3,"div",36),e.TgZ(4,"div",37),e.TgZ(5,"div",38),e.TgZ(6,"div",39),e.TgZ(7,"mat-form-field",40),e.TgZ(8,"mat-label"),e._uU(9,"Name"),e.qZA(),e._UZ(10,"input",41),e.qZA(),e.TgZ(11,"mat-form-field",42),e.TgZ(12,"mat-label"),e._uU(13,"Contact"),e.qZA(),e._UZ(14,"input",41),e.qZA(),e.qZA(),e.TgZ(15,"div",43),e.TgZ(16,"mat-form-field",44),e._UZ(17,"textarea",45),e._UZ(18,"mat-icon",6),e.qZA(),e.qZA(),e.TgZ(19,"div",43),e.TgZ(20,"mat-form-field",44),e._UZ(21,"textarea",45),e._UZ(22,"mat-icon",6),e.qZA(),e.TgZ(23,"mat-form-field",42),e.TgZ(24,"mat-label"),e._uU(25,"pincode"),e.qZA(),e._UZ(26,"input",41),e.qZA(),e.qZA(),e.TgZ(27,"div",43),e.TgZ(28,"mat-form-field",42),e.TgZ(29,"mat-label"),e._uU(30,"Donation Time"),e.qZA(),e._UZ(31,"input",41),e.qZA(),e.qZA(),e.TgZ(32,"div",43),e.TgZ(33,"mat-form-field",46),e.TgZ(34,"mat-label"),e._uU(35,"Volunteers"),e.qZA(),e.TgZ(36,"mat-select",47),e.YNc(37,ie,3,2,"ng-container",48),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(38,"div",49),e.TgZ(39,"span",50),e._uU(40," Status"),e.qZA(),e.TgZ(41,"mat-slide-toggle",51),e._uU(42),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(43,"div",52),e.TgZ(44,"div",53),e.YNc(45,le,3,2,"div",54),e.TgZ(46,"button",55),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateSelectedOrder()}),e._uU(47," Update "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&r){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.selectedOrderForm),e.xp6(8),e.Q6J("formControlName","name")("readonly",!0),e.xp6(4),e.Q6J("formControlName","phone")("readonly",!0),e.xp6(3),e.Q6J("placeholder","Pickup Address")("rows",3)("formControlName","pickupAddress")("readonly",!0),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(3),e.Q6J("placeholder","Drop Address")("rows",3)("formControlName","dropAddress")("readonly",!0),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(4),e.Q6J("formControlName","pincode")("readonly",!0),e.xp6(5),e.Q6J("formControlName","donationTime")("readonly",!0),e.xp6(5),e.Q6J("formControlName","assignedVolunteerId"),e.xp6(1),e.Q6J("ngForOf",t.volunteers),e.xp6(4),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===t.selectedOrderForm.get("active").value?"Active":"Disabled"," "),e.xp6(3),e.Q6J("ngIf",t.flashMessage),e.xp6(1),e.Q6J("color","primary")}}function ce(r,i){1&r&&(e.TgZ(0,"div",61),e._uU(1,"There are no Orders!"),e.qZA())}let ge=(()=>{class r{constructor(t,o,s,l,d){this._changeDetectorRef=t,this._fuseConfirmationService=o,this._formBuilder=s,this._ordersService=l,this._volunteersService=d,this.flashMessage=null,this.isLoading=!1,this.searchInputControl=new a.NI,this.selectedOrder=null,this._unsubscribeAll=new k.xQ}ngOnInit(){this.selectedOrderForm=this._formBuilder.group({id:[""],pickupAddress:["",[a.kI.required]],dropAddress:["",[a.kI.required]],currentState:[""],customerId:[""],donor:this._formBuilder.group({id:[""],name:["",[a.kI.required]],phone:["",[a.kI.required]],email:["",[a.kI.required]],address:["",[a.kI.required]],pincode:["",[a.kI.required]]}),assignedVolunteerId:[""],time:[""],date:[""],pincode:[""],donationTime:[""],active:[!1]}),this._ordersService.pagination$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.orders$=this._ordersService.orders$,this.searchInputControl.valueChanges.pipe((0,u.R)(this._unsubscribeAll),(0,w.b)(300),(0,c.w)(t=>(this.closeDetails(),this.isLoading=!0,this._ordersService.getOrders(0,10,"pickupAddress","asc",t))),(0,f.U)(()=>{this.isLoading=!1})).subscribe(),this._volunteersService.volunteers$.pipe((0,u.R)(this._unsubscribeAll)).subscribe(t=>{this.volunteers=t,console.log(this.volunteers),this._changeDetectorRef.markForCheck()})}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"pickupAddress",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,u.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0,this.closeDetails()}),(0,F.T)(this._sort.sortChange,this._paginator.page).pipe((0,c.w)(()=>(this.closeDetails(),this.isLoading=!0,this._ordersService.getOrders(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,f.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}toggleDetails(t){this.selectedOrder&&this.selectedOrder.id===t?this.closeDetails():this._ordersService.getOrderById(t).subscribe(o=>{this.selectedOrder=o,this.selectedOrderForm.patchValue(o),this.selectedOrderForm.patchValue({assignedVolunteerId:parseInt(o.volunteer.id)}),this._changeDetectorRef.markForCheck()})}closeDetails(){this.selectedOrder=null}updateSelectedOrder(){const t=this.selectedOrderForm.getRawValue();this._ordersService.updateOrder(t.id,t.assignedVolunteerId).subscribe(()=>{this.showFlashMessage("success")})}showFlashMessage(t){this.flashMessage=t,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}trackByFn(t,o){return o.id||t}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(e.sBO),e.Y36(R.R),e.Y36(a.qu),e.Y36(J),e.Y36($.C))},r.\u0275cmp=e.Xpm({type:r,selectors:[["orders-list"]],viewQuery:function(t,o){if(1&t&&(e.Gf(x.NW,5),e.Gf(m.YE,5)),2&t){let s;e.iGM(s=e.CRH())&&(o._paginator=s.first),e.iGM(s=e.CRH())&&(o._sort=s.first)}},decls:17,vars:8,consts:[[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","flex-shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden","sm:overflow-y-auto"],[4,"ngIf"],["rowDetailsTemplate",""],["noOrder",""],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"orders-grid","z-10","sticky","top-0","grid","gap-4","py-4","px-6","md:px-8","shadow","text-md","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"lg:flex","items-center",3,"mat-sort-header"],[1,"hidden","lg:flex","items-center",3,"mat-sort-header"],[1,"hidden","sm:flex","items-center"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"orders-grid","grid","items-center","gap-4","py-3","px-6","md:px-8","border-b"],[1,""],[1,"lg:flex","items-center"],[1,"hidden","lg:block","truncate"],[1,"hidden","lg:block"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-gray-400","icon-size-5",3,"svgIcon"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"shadow-lg","overflow-hidden"],[1,"flex","border-b"],[1,"flex","flex-col","w-full",3,"formGroup"],[1,"flex","flex-col","sm:flex-row","p-8"],[1,"flex","flex-auto","flex-wrap"],[1,"flex","flex-col","w-full","lg:w-3/4","sm:pl-8"],["formGroupName","donor"],[1,"w-2/3"],["matInput","",3,"formControlName","readonly"],[1,"w-1/3","pl-2"],[1,"flex"],[1,"fuse-mat-textarea","flex-auto","w-2/3","pr-2"],["matInput","",3,"placeholder","rows","formControlName","readonly"],[1,"w-1/3","pr-2"],[3,"formControlName"],[4,"ngFor","ngForOf"],[1,"flex","flex-col","w-full","lg:w-1/4","sm:pl-8"],[1,"font-semibold","mb-2"],[3,"formControlName","color"],[1,"flex","items-center","justify-between","w-full","border-t","px-8","py-4"],[1,"flex","items-center"],["class","flex items-center mr-4",4,"ngIf"],["mat-flat-button","",3,"color","click"],[3,"value"],[1,"flex","items-center","mr-4"],[1,"text-green-500",3,"svgIcon"],[1,"ml-2"],[1,"text-red-500",3,"svgIcon"],[1,"p-8","sm:p-16","border-t","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,z,2,1,"div",2),e.TgZ(3,"div",3),e._uU(4,"Donations"),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"mat-form-field",5),e._UZ(7,"mat-icon",6),e._UZ(8,"input",7),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"div",8),e.TgZ(10,"div",9),e.YNc(11,oe,2,2,"ng-container",10),e.ALo(12,"async"),e.YNc(13,de,48,26,"ng-template",null,11,e.W1O),e.YNc(15,ce,2,0,"ng-template",null,12,e.W1O),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",o.isLoading),e.xp6(5),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",o.searchInputControl)("autocomplete","off")("placeholder","Search Order"),e.xp6(3),e.Q6J("ngIf",e.lcZ(12,6,o.orders$)))},directives:[g.O5,p.KE,A.Hw,p.qo,C.Nt,a.Fj,a.JJ,a.oH,b.pW,m.YE,m.nU,x.NW,g.mk,g.sg,O.lW,g.tP,a._Y,a.JL,a.sg,a.x0,p.hX,a.u,y.gD,Q.Rr,I.ey],pipes:[g.Ov],styles:[".orders-grid{grid-template-columns:48px auto 40px}@media (min-width: 600px){.orders-grid{grid-template-columns:48px auto 112px 72px}}@media (min-width: 960px){.orders-grid{grid-template-columns:48px 112px auto 112px 72px}}@media (min-width: 1280px){.orders-grid{grid-template-columns:40px 150px 100px 200px 150px 100px 30px 30px}}\n"],encapsulation:2,data:{animation:S.L},changeDetection:0}),r})();const fe=[{path:"",component:(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-orders"]],decls:1,vars:0,template:function(t,o){1&t&&e._UZ(0,"router-outlet")},directives:[T.lC],encapsulation:2,changeDetection:0}),r})(),children:[{path:"",component:ge,resolve:{orders:(()=>{class r{constructor(t){this._ordersService=t}resolve(t,o){return this._ordersService.getOrders()}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(J))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),volunteers:n(5164).D}}]}];let he=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[T.Bz.forChild(fe),O.ot,q.p9,p.lN,A.Ps,C.c,D.Tx,x.TU,b.Cv,I.si,m.JX,y.LD,Q.rP,N.AV,L.m]]}),r})()}}]);