"use strict";(self.webpackChunk_dashboard=self.webpackChunk_dashboard||[]).push([[330],{8330:(be,O,s)=>{s.r(O),s.d(O,{DonorsOrdersModule:()=>Te});var I=s(3423),_=s(1095),Q=s(7539),d=s(8295),v=s(6627),Z=s(9983),N=s(3935),T=s(9692),w=s(2178),q=s(2458),h=s(1494),L=s(7441),U=s(5396),S=s(1436),M=s(4466),l=s(3679),F=s(9765),R=s(6682),b=s(6782),Y=s(4395),m=s(3190),u=s(8002),B=s(1452),e=s(7716),C=s(2238),y=s(6215),j=s(205),$=s(5917),k=s(3342),f=s(5257),z=s(5435),J=s(1841);let A=(()=>{class n{constructor(t){this._httpClient=t,this._orders=new y.X(null),this._order=new y.X(null),this._pagination=new y.X(null)}get orders$(){return this._orders.asObservable()}get order$(){return this._order.asObservable()}get pagination$(){return this._pagination.asObservable()}getOrders(t=0,o=10,i="pickupAddress",a="asc",c=""){return this._httpClient.get("http://13.51.195.30:8080/donor/donations",{params:{page:""+t,size:""+o,sort:i,order:a,search:c}}).pipe((0,k.b)(g=>{this._pagination.next(g.pagination),this._orders.next(g.donations)}))}getOrderById(t){return this.orders$.pipe((0,f.q)(1),(0,u.U)(o=>{const i=o.find(a=>a.id===t)||null;return this._order.next(i),i}),(0,m.w)(o=>o?(0,$.of)(o):(0,j._)("Could not find order with id of "+t+"!")))}updateOrder(t,o){return this.orders$.pipe((0,f.q)(1),(0,m.w)(i=>this._httpClient.patch("http://13.51.195.30:8080/donor/donation/"+t,{id:t,volunteerID:o}).pipe((0,u.U)(a=>{const c=i.findIndex(g=>g.id===t);return i[c]=a,this._orders.next(i),a}),(0,m.w)(a=>this.order$.pipe((0,f.q)(1),(0,z.h)(c=>c&&c.id===t),(0,k.b)(()=>(this._order.next(a),a)))))))}createDonation(t){return console.log(t),this.orders$.pipe((0,f.q)(1),(0,m.w)(o=>this._httpClient.post("http://13.51.195.30:8080/donor/donation",t).pipe((0,u.U)(i=>(this._orders.next([i,...o]),i)))))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(J.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var p=s(8583),x=s(3220);const V=["itemSelect"];function E(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",31),e._uU(2),e.qZA(),e.BQk()),2&n){const t=r.$implicit;e.xp6(1),e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.time," ")}}function G(n,r){if(1&n&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&n){const t=r.$implicit;e.Q6J("value",t),e.xp6(1),e.hij(" ",t.name," ")}}function H(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"li",32),e.TgZ(1,"span",33),e._uU(2),e.qZA(),e.TgZ(3,"button",34),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw().decreaseQuantity(a)}),e._uU(4," - "),e.qZA(),e.TgZ(5,"button",35),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw().increaseQuantity(a)}),e._uU(6," + "),e.qZA(),e.TgZ(7,"button",36),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw().removeChip(a)}),e._uU(8," x "),e.qZA(),e.qZA()}if(2&n){const t=r.$implicit,o=r.index;e.Udp("background",o%2==0?"#f9f9f9":"#e0e0e0"),e.xp6(2),e.lnq("",o+1,". ",t.name," (",t.quantity,")")}}let W=(()=>{class n{constructor(t,o,i){this.matDialogRef=t,this._formBuilder=o,this._ordersService=i,this.todayDate=new Date,this.chips=["Food","Clothes","Books"],this.selectedItemControl=new l.NI(null),this.searchTerm="",this.selectedChips=[],this.availableItems=[{name:"Rice",quantity:1},{name:"Wheat",quantity:1},{name:"Sugar",quantity:1},{name:"Pulses",quantity:1},{name:"Flour",quantity:1},{name:"Salt",quantity:1},{name:"Oil",quantity:1}],this.availableItemsNon=[{name:"Dal",quantity:1},{name:"Paneer",quantity:1}],this.filteredItems=[...this.availableItems]}ngOnInit(){this.createdDonation=this._formBuilder.group({donationTime:["",[l.kI.required]],donationDate:["",[l.kI.required]],selectedItems:this._formBuilder.array([])}),this.availableTime=[{id:"Afternoon",time:"Afternoon"},{id:"Dinner",time:"Dinner"}],this.todayDate.setDate(this.todayDate.getDate()+1)}discard(){this.matDialogRef.close()}donate(){const t=this.selectedChips.map(i=>({name:i.name,quantity:i.quantity}));console.log(t);let o={id:"empty",currentState:"Added",donationTime:this.createdDonation.getRawValue().donationTime,donationDate:this.createdDonation.getRawValue().donationDate,pickupAddress:"",dropAddress:"",volunteerName:"",pincode:"",selectedItems:t};this._ordersService.createDonation(o).subscribe(i=>{this.matDialogRef.close()})}filterItems(){this.filteredItems=this.availableItems.filter(t=>t.name.toLowerCase().includes(this.searchTerm.toLowerCase()))}onItemSelect(t){if(!t)return;const o=this.selectedChips.find(i=>i.name===t.name);o?o.quantity++:this.selectedChips.push(Object.assign(Object.assign({},t),{quantity:1})),this.selectedItemControl.setValue(null)}increaseQuantity(t){t.quantity++}decreaseQuantity(t){t.quantity>1?t.quantity--:this.removeChip(t)}removeChip(t){this.selectedChips=this.selectedChips.filter(o=>o!==t)}selectFoodType(t){this.selectedFoodType=t,console.log(this.selectedFoodType),"non-veg"===this.selectedFoodType?this.filteredItems=[...this.availableItemsNon]:"veg"===this.selectedFoodType&&(this.filteredItems=[...this.availableItems])}toggleItemSelection(t){const o=this.createdDonation.get("selectedItems"),i=o.controls.findIndex(a=>a.value===t.name);i>-1?o.removeAt(i):o.push(new l.NI(t.name))}closeDropdown(t){t.close()}openDropdown(t){t.open()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(C.so),e.Y36(l.qu),e.Y36(A))},n.\u0275cmp=e.Xpm({type:n,selectors:[["mailbox-compose"]],viewQuery:function(t,o){if(1&t&&e.Gf(V,5),2&t){let i;e.iGM(i=e.CRH())&&(o.itemSelect=i.first)}},decls:44,vars:16,consts:[[1,"flex","flex-col","max-w-240","md:min-w-160","max-h-screen","-m-6"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","",3,"tabIndex","click"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto",3,"formGroup"],[3,"formControlName"],[4,"ngFor","ngForOf"],[1,"flex-auto"],["matInput","",3,"matDatepicker","formControlName","min"],["matSuffix","",3,"for"],["picker1",""],[1,"flex","items-center","space-x-4","mt-4"],["mat-icon-button","",3,"color","click"],["src","../../../../../assets/icons/veg-icon.png","alt","Veg","width","30","height","30"],["src","../../../../../assets/icons/non-veg-icon.png","alt","Non-Veg","width","30","height","30"],[1,"flex","flex-col","flex-auto","p-6","sm:p-8","overflow-y-auto"],[2,"display","flex","flex-direction","column","gap","8px","width","100%"],[2,"width","100%","min-width","200px"],[3,"formControl","selectionChange"],["itemSelect",""],["type","text","placeholder","Search items...",2,"width","100%","padding","5px","border","1px solid #ccc","border-radius","4px","outline","none",3,"ngModel","ngModelChange","keyup"],[3,"value",4,"ngFor","ngForOf"],[2,"margin-top","10px"],[2,"list-style","none","padding-left","20px","margin","0"],["style","\n                            margin-bottom: 10px;\n                            padding: 8px 10px;\n                            display: flex;\n                            align-items: center;\n                            gap: 10px;\n                            border-radius: 5px;\n                        ",3,"background",4,"ngFor","ngForOf"],[1,"flex","flex-col","sm:flex-row","sm:items-center","justify-between","mt-4","sm:mt-6"],[1,"-ml-2"],[1,"flex","items-center","mt-4","sm:mt-0"],["mat-stroked-button","",1,"ml-auto","sm:ml-0",3,"click"],["mat-flat-button","",1,"order-first","sm:order-last",3,"color","click"],[3,"value"],[2,"margin-bottom","10px","padding","8px 10px","display","flex","align-items","center","gap","10px","border-radius","5px"],[2,"flex","1"],[2,"background","red","color","white","border","none","padding","6px 10px","border-radius","4px",3,"click"],[2,"background","green","color","white","border","none","padding","6px 10px","border-radius","4px",3,"click"],[2,"background","gray","color","white","border","none","padding","6px 10px","border-radius","4px",3,"click"]],template:function(t,o){if(1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._uU(3,"New Donation"),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return o.discard()}),e._UZ(5,"mat-icon",4),e.qZA(),e.qZA(),e.TgZ(6,"form",5),e.TgZ(7,"mat-form-field"),e.TgZ(8,"mat-label"),e._uU(9,"Select Time"),e.qZA(),e.TgZ(10,"mat-select",6),e.YNc(11,E,3,2,"ng-container",7),e.qZA(),e.qZA(),e.TgZ(12,"mat-form-field",8),e.TgZ(13,"mat-label"),e._uU(14,"Choose a date"),e.qZA(),e._UZ(15,"input",9),e._UZ(16,"mat-datepicker-toggle",10),e._UZ(17,"mat-datepicker",null,11),e.qZA(),e.TgZ(19,"div",12),e.TgZ(20,"button",13),e.NdJ("click",function(){return o.selectFoodType("veg")}),e._UZ(21,"img",14),e.qZA(),e.TgZ(22,"button",13),e.NdJ("click",function(){return o.selectFoodType("non-veg")}),e._UZ(23,"img",15),e.qZA(),e.qZA(),e.qZA(),e.TgZ(24,"div",16),e.TgZ(25,"div",17),e.TgZ(26,"mat-form-field",18),e.TgZ(27,"mat-label"),e._uU(28,"Select Items"),e.qZA(),e.TgZ(29,"mat-select",19,20),e.NdJ("selectionChange",function(a){return o.onItemSelect(a.value)}),e.TgZ(31,"mat-option"),e.TgZ(32,"input",21),e.NdJ("ngModelChange",function(a){return o.searchTerm=a})("keyup",function(){return o.filterItems()}),e.qZA(),e.qZA(),e.YNc(33,G,2,2,"mat-option",22),e.qZA(),e.qZA(),e.TgZ(34,"div",23),e.TgZ(35,"ul",24),e.YNc(36,H,9,5,"li",25),e.qZA(),e.qZA(),e.qZA(),e.TgZ(37,"div",26),e._UZ(38,"div",27),e.TgZ(39,"div",28),e.TgZ(40,"button",29),e.NdJ("click",function(){return o.discard()}),e._uU(41," Discard "),e.qZA(),e.TgZ(42,"button",30),e.NdJ("click",function(){return o.donate()}),e._uU(43," Donate "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t){const i=e.MAs(18);e.xp6(4),e.Q6J("tabIndex",-1),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:x"),e.xp6(1),e.Q6J("formGroup",o.createdDonation),e.xp6(4),e.Q6J("formControlName","donationTime"),e.xp6(1),e.Q6J("ngForOf",o.availableTime),e.xp6(4),e.Q6J("matDatepicker",i)("formControlName","donationDate")("min",o.todayDate),e.xp6(1),e.Q6J("for",i),e.xp6(4),e.Q6J("color","veg"===o.selectedFoodType?"primary":"basic"),e.xp6(2),e.Q6J("color","non-veg"===o.selectedFoodType?"warn":"basic"),e.xp6(7),e.Q6J("formControl",o.selectedItemControl),e.xp6(3),e.Q6J("ngModel",o.searchTerm),e.xp6(1),e.Q6J("ngForOf",o.filteredItems),e.xp6(3),e.Q6J("ngForOf",o.selectedChips),e.xp6(6),e.Q6J("color","primary")}},directives:[_.lW,v.Hw,l._Y,l.JL,l.sg,d.KE,d.hX,L.gD,l.JJ,l.u,p.sg,Z.Nt,x.hl,l.Fj,x.nW,d.R9,x.Mq,l.oH,q.ey,l.On],encapsulation:2}),n})();var D=s(6457);let X=(()=>{class n{constructor(){this.volunteerLat=28.5,this.volunteerLng=77.4,this.donorLat=28.6139,this.donorLng=77.209,this.estimatedTime=""}ngOnInit(){this.trackVolunteer(),this.directionsService=new google.maps.DirectionsService,this.directionsRenderer=new google.maps.DirectionsRenderer,this.distanceService=new google.maps.DistanceMatrixService}trackVolunteer(){navigator.geolocation&&navigator.geolocation.watchPosition(t=>{this.volunteerLat=t.coords.latitude,this.volunteerLng=t.coords.longitude,this.getRoute(),this.getEstimatedTime()})}onMapReady(t){this.map=t,this.directionsRenderer.setMap(this.map),this.getRoute(),this.getEstimatedTime()}getRoute(){if(!this.map||!this.donorLat||!this.volunteerLat)return;const t={origin:{lat:this.volunteerLat,lng:this.volunteerLng},destination:{lat:this.donorLat,lng:this.donorLng},travelMode:google.maps.TravelMode.DRIVING};this.directionsService.route(t,(o,i)=>{i===google.maps.DirectionsStatus.OK&&this.directionsRenderer.setDirections(o)})}getEstimatedTime(){!this.donorLat||!this.volunteerLat||this.distanceService.getDistanceMatrix({origins:[{lat:this.volunteerLat,lng:this.volunteerLng}],destinations:[{lat:this.donorLat,lng:this.donorLng}],travelMode:google.maps.TravelMode.DRIVING},(t,o)=>{if("OK"===o){const i=t.rows[0].elements[0];"OK"===i.status&&(this.estimatedTime=i.duration.text)}})}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-location-dialog"]],decls:6,vars:10,consts:[[1,"map-container"],[2,"height","600px",3,"latitude","longitude","zoom","mapReady"],[3,"latitude","longitude","iconUrl"],[3,"latitude","longitude","label"],[1,"estimated-time",2,"margin","20px","font-weight","bold","font-size","16px","color","#333","padding","8px","background","#f8f9fa","border-radius","5px","display","inline-block","box-shadow","2px 2px 5px rgba(0, 0, 0, 0.1)"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"agm-map",1),e.NdJ("mapReady",function(a){return o.onMapReady(a)}),e._UZ(2,"agm-marker",2),e._UZ(3,"agm-marker",3),e.qZA(),e.TgZ(4,"div",4),e._uU(5),e.qZA(),e.qZA()),2&t&&(e.xp6(1),e.Q6J("latitude",o.donorLat)("longitude",o.donorLng)("zoom",14),e.xp6(1),e.Q6J("latitude",o.volunteerLat)("longitude",o.volunteerLng)("iconUrl","assets/icons/car.png"),e.xp6(1),e.Q6J("latitude",o.donorLat)("longitude",o.donorLng)("label","Donor"),e.xp6(2),e.hij(" Estimated Arrival Time: ",o.estimatedTime||"Calculating..."," "))},directives:[D.SA,D.pt],styles:[""]}),n})();var P=s(1400);function K(n,r){1&n&&(e.TgZ(0,"div",16),e._UZ(1,"mat-progress-bar",17),e.qZA()),2&n&&(e.xp6(1),e.Q6J("mode","indeterminate"))}function ee(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",29),e._uU(2),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(2),e.hij(" ",t.volunteerName," ")}}function te(n,r){1&n&&(e.ynx(0),e.TgZ(1,"div",29),e._uU(2," - "),e.qZA(),e.BQk())}function oe(n,r){1&n&&(e.ynx(0),e.TgZ(1,"span",32),e._uU(2," Order Placed "),e.qZA(),e.BQk())}function ne(n,r){1&n&&(e.ynx(0),e.TgZ(1,"span",33),e._uU(2," Cancelled "),e.qZA(),e.BQk())}function ie(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",27),e.TgZ(2,"div",28),e._uU(3),e.qZA(),e.YNc(4,ee,3,1,"ng-container",13),e.YNc(5,te,3,0,"ng-container",13),e.TgZ(6,"div",29),e._uU(7),e.ALo(8,"date"),e.qZA(),e.TgZ(9,"div",29),e._uU(10),e.qZA(),e.TgZ(11,"div",30),e.YNc(12,oe,3,0,"ng-container",13),e.YNc(13,ne,3,0,"ng-container",13),e.qZA(),e.ynx(14),e.TgZ(15,"button",31),e.NdJ("click",function(){return e.CHM(t),e.oxw(4).locationDialog()}),e.TgZ(16,"mat-icon"),e._uU(17,"navigation"),e.qZA(),e.qZA(),e.BQk(),e.qZA(),e._UZ(18,"div",19),e.BQk()}if(2&n){const t=r.$implicit,o=r.index,i=e.oxw(4);e.xp6(3),e.hij(" ",o+1," "),e.xp6(1),e.Q6J("ngIf",t.volunteerName),e.xp6(1),e.Q6J("ngIf",!t.volunteerName),e.xp6(2),e.hij(" ",e.Dn7(8,7,t.donationDate,i.format,i.timezone)," "),e.xp6(3),e.hij(" ",t.donationTime," "),e.xp6(2),e.Q6J("ngIf","Donation Provided"==t.currentState),e.xp6(1),e.Q6J("ngIf","Donation "==t.currentState)}}function re(n,r){if(1&n&&(e.ynx(0),e.YNc(1,ie,19,11,"ng-container",26),e.BQk()),2&n){const t=r.ngIf,o=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",o.trackByFn)}}const se=function(n){return{"pointer-events-none":n}},ae=function(){return[5,10,25,100]};function le(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",19),e.TgZ(2,"div",20),e.TgZ(3,"div",21),e._uU(4," S. No. "),e.qZA(),e.TgZ(5,"div",22),e._uU(6," Volunteer "),e.qZA(),e.TgZ(7,"div",22),e._uU(8," Scheduled Date "),e.qZA(),e.TgZ(9,"div",22),e._uU(10," Scheduled Time "),e.qZA(),e.TgZ(11,"div",23),e._uU(12," Active "),e.qZA(),e.TgZ(13,"div",24),e._uU(14," Status "),e.qZA(),e.qZA(),e.YNc(15,re,2,2,"ng-container",13),e.ALo(16,"async"),e.qZA(),e._UZ(17,"mat-paginator",25),e.BQk()),2&n){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","serial_number"),e.xp6(2),e.Q6J("mat-sort-header","volunteerName"),e.xp6(2),e.Q6J("mat-sort-header","donationDate"),e.xp6(2),e.Q6J("mat-sort-header","donationTime"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(16,12,t.orders$)),e.xp6(2),e.Q6J("ngClass",e.VKq(14,se,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(16,ae))("showFirstLastButtons",!0)}}function ce(n,r){if(1&n&&(e.ynx(0),e.YNc(1,le,18,17,"ng-container",18),e.BQk()),2&n){const t=r.ngIf;e.oxw();const o=e.MAs(20);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",o)}}function de(n,r){1&n&&(e.ynx(0),e._UZ(1,"mat-icon",55),e.TgZ(2,"span",56),e._uU(3,"Donation Data updated"),e.qZA(),e.BQk()),2&n&&(e.xp6(1),e.Q6J("svgIcon","heroicons_outline:check"))}function me(n,r){1&n&&(e.ynx(0),e._UZ(1,"mat-icon",57),e.TgZ(2,"span",56),e._uU(3,"An error occurred, try again!"),e.qZA(),e.BQk()),2&n&&(e.xp6(1),e.Q6J("svgIcon","heroicons_outline:x"))}function pe(n,r){if(1&n&&(e.TgZ(0,"div",54),e.YNc(1,de,4,1,"ng-container",13),e.YNc(2,me,4,1,"ng-container",13),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf","success"===t.flashMessage),e.xp6(1),e.Q6J("ngIf","error"===t.flashMessage)}}function ge(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div",34),e.TgZ(1,"div",35),e.TgZ(2,"form",36),e.TgZ(3,"div",37),e.TgZ(4,"div",38),e.TgZ(5,"div",39),e.TgZ(6,"div",40),e.TgZ(7,"mat-form-field",41),e.TgZ(8,"mat-label"),e._uU(9,"Name"),e.qZA(),e._UZ(10,"input",42),e.qZA(),e.TgZ(11,"mat-form-field",43),e.TgZ(12,"mat-label"),e._uU(13,"Contact"),e.qZA(),e._UZ(14,"input",42),e.qZA(),e.qZA(),e.TgZ(15,"div",44),e.TgZ(16,"mat-form-field",45),e._UZ(17,"textarea",46),e._UZ(18,"mat-icon",6),e.qZA(),e.qZA(),e.TgZ(19,"div",44),e.TgZ(20,"mat-form-field",45),e._UZ(21,"textarea",46),e._UZ(22,"mat-icon",6),e.qZA(),e.TgZ(23,"mat-form-field",43),e.TgZ(24,"mat-label"),e._uU(25,"pincode"),e.qZA(),e._UZ(26,"input",42),e.qZA(),e.qZA(),e.TgZ(27,"div",44),e.TgZ(28,"mat-form-field",43),e.TgZ(29,"mat-label"),e._uU(30,"Donation Time"),e.qZA(),e._UZ(31,"input",42),e.qZA(),e.qZA(),e.qZA(),e.TgZ(32,"div",47),e.TgZ(33,"span",48),e._uU(34," Status"),e.qZA(),e.TgZ(35,"mat-slide-toggle",49),e._uU(36),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(37,"div",50),e.TgZ(38,"div",51),e.YNc(39,pe,3,2,"div",52),e.TgZ(40,"button",53),e.NdJ("click",function(){return e.CHM(t),e.oxw().updateSelectedOrder()}),e._uU(41," Update "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.selectedOrderForm),e.xp6(8),e.Q6J("formControlName","name")("readonly",!0),e.xp6(4),e.Q6J("formControlName","phone")("readonly",!0),e.xp6(3),e.Q6J("placeholder","Pickup Address")("rows",3)("formControlName","pickupAddress")("readonly",!0),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(3),e.Q6J("placeholder","Drop Address")("rows",3)("formControlName","dropAddress")("readonly",!0),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(4),e.Q6J("formControlName","pincode")("readonly",!0),e.xp6(5),e.Q6J("formControlName","donationTime")("readonly",!0),e.xp6(4),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===t.selectedOrderForm.get("active").value?"Active":"Disabled"," "),e.xp6(3),e.Q6J("ngIf",t.flashMessage),e.xp6(1),e.Q6J("color","primary")}}function ue(n,r){1&n&&(e.TgZ(0,"div",58),e._uU(1," There are no Orders! "),e.qZA())}let he=(()=>{class n{constructor(t,o,i,a,c,g){this._changeDetectorRef=t,this._fuseConfirmationService=o,this._formBuilder=i,this._ordersService=a,this._matDialog=c,this.http=g,this.flashMessage=null,this.isLoading=!1,this.searchInputControl=new l.NI,this.selectedOrder=null,this._unsubscribeAll=new F.xQ,this.volunteerLat=0,this.volunteerLng=0,this.donorLat=0,this.donorLng=0}ngOnInit(){this.directionsService=new google.maps.DirectionsService,this.directionsDisplay=new google.maps.DirectionsRenderer,this.selectedOrderForm=this._formBuilder.group({id:[""],pickupAddress:["",[l.kI.required]],dropAddress:["",[l.kI.required]],currentState:[""],customerId:[""],volunteerName:[""],time:[""],date:[""],pincode:[""],donationTime:[""],active:[!1],status:[!1]}),this._ordersService.pagination$.pipe((0,b.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.orders$=this._ordersService.orders$,this.searchInputControl.valueChanges.pipe((0,b.R)(this._unsubscribeAll),(0,Y.b)(300),(0,m.w)(t=>(this.closeDetails(),this.isLoading=!0,this._ordersService.getOrders(0,10,"pickupAddress","asc",t))),(0,u.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this.orders$.subscribe(t=>{console.log("Orders:",t)}),this._sort&&this._paginator&&(this._sort.sort({id:"pickupAddress",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,b.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0,this.closeDetails()}),(0,R.T)(this._sort.sortChange,this._paginator.page).pipe((0,m.w)(()=>(this.closeDetails(),this.isLoading=!0,this._ordersService.getOrders(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,u.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}toggleDetails(t){this.selectedOrder&&this.selectedOrder.id===t?this.closeDetails():this._ordersService.getOrderById(t).subscribe(o=>{this.selectedOrder=o,this.selectedOrderForm.patchValue(o),this._changeDetectorRef.markForCheck()})}closeDetails(){this.selectedOrder=null}updateSelectedOrder(){const t=this.selectedOrderForm.getRawValue();this._ordersService.updateOrder(t.id,t.assignedVolunteerId).subscribe(()=>{this.showFlashMessage("success")})}showFlashMessage(t){this.flashMessage=t,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}trackByFn(t,o){return o.id||t}openDonationDialog(){this._matDialog.open(W).afterClosed().subscribe(o=>{console.log("Compose dialog was closed!")})}getCoordinates(t){this.http.get(`https://maps.googleapis.com/maps/api/geocode/json?address=${t}&key=AIzaSyDpSpG2tYsXynSyTvf-Y0UuThqeh2tEsnI`).subscribe(o=>{if("OK"===o.status){const i=o.results[0].geometry.location;this.volunteerLat=i.lat,this.volunteerLng=i.lng}})}trackVolunteer(){navigator.geolocation&&navigator.geolocation.watchPosition(t=>{this.volunteerLat=t.coords.latitude,this.volunteerLng=t.coords.longitude})}getRoute(){this.directionsService.route({origin:{lat:this.volunteerLat,lng:this.volunteerLng},destination:{lat:this.donorLat,lng:this.donorLng},travelMode:google.maps.TravelMode.DRIVING},(t,o)=>{o===google.maps.DirectionsStatus.OK&&this.directionsDisplay.setDirections(t)})}locationDialog(){const t=window.innerWidth;window,this._matDialog.open(X,{width:t<600?"90vw":"1200px",height:t<600?"80vh":"800px"}).afterClosed().subscribe(()=>{console.log("Location dialog was closed!")})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(P.R),e.Y36(l.qu),e.Y36(A),e.Y36(C.uw),e.Y36(J.eN))},n.\u0275cmp=e.Xpm({type:n,selectors:[["orders-list"]],viewQuery:function(t,o){if(1&t&&(e.Gf(T.NW,5),e.Gf(h.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(o._paginator=i.first),e.iGM(i=e.CRH())&&(o._sort=i.first)}},decls:21,vars:10,consts:[[1,"sm:absolute","sm:inset-0","flex","flex-col","flex-auto","min-w-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","py-8","px-6","md:px-8","border-b"],["class","absolute inset-x-0 bottom-0",4,"ngIf"],[1,"text-4xl","font-extrabold","tracking-tight"],[1,"flex","flex-shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-flat-button","",1,"ml-4",3,"color","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-hidden","sm:overflow-y-auto"],[4,"ngIf"],["rowDetailsTemplate",""],["noOrder",""],[1,"absolute","inset-x-0","bottom-0"],[3,"mode"],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"orders-grid","z-10","sticky","top-0","grid","gap-4","py-4","px-6","md:px-8","shadow","text-md","font-semibold","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"lg:flex","items-center",3,"mat-sort-header"],[1,"sm:flex","items-center",3,"mat-sort-header"],[1,"hidden","lg:flex","items-center",3,"mat-sort-header"],[1,"lg:flex","items-center"],[1,"sm:absolute","sm:inset-x-0","sm:bottom-0","border-b","sm:border-t","sm:border-b-0","z-10","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"orders-grid","grid","items-center","gap-4","py-3","px-6","md:px-8","border-b"],[1,""],[1,"sm:block","truncate"],[1,"hidden","lg:block"],["mat-icon-button","",3,"click"],[2,"display","inline-block","padding","6px 12px","background-color","#32cf386b","color","white","text-align","center","white-space","nowrap"],[2,"display","inline-block","padding","6px 12px","border-radius","16px","background-color","#c92f2f","color","white","font-size","14px","text-align","center","white-space","nowrap"],[1,"shadow-lg","overflow-hidden"],[1,"flex","border-b"],[1,"flex","flex-col","w-full",3,"formGroup"],[1,"flex","flex-col","sm:flex-row","p-8"],[1,"flex","flex-auto","flex-wrap"],[1,"flex","flex-col","w-full","lg:w-3/4","sm:pl-8"],["formGroupName","donor"],[1,"w-2/3"],["matInput","",3,"formControlName","readonly"],[1,"w-1/3","pl-2"],[1,"flex"],[1,"fuse-mat-textarea","flex-auto","w-2/3","pr-2"],["matInput","",3,"placeholder","rows","formControlName","readonly"],[1,"flex","flex-col","w-full","lg:w-1/4","sm:pl-8"],[1,"font-semibold","mb-2"],[3,"formControlName","color"],[1,"flex","items-center","justify-between","w-full","border-t","px-8","py-4"],[1,"flex","items-center"],["class","flex items-center mr-4",4,"ngIf"],["mat-flat-button","",3,"color","click"],[1,"flex","items-center","mr-4"],[1,"text-green-500",3,"svgIcon"],[1,"ml-2"],[1,"text-red-500",3,"svgIcon"],[1,"p-8","sm:p-16","border-t","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,K,2,1,"div",2),e.TgZ(3,"div",3),e._uU(4,"Donations"),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"mat-form-field",5),e._UZ(7,"mat-icon",6),e._UZ(8,"input",7),e.qZA(),e.TgZ(9,"button",8),e.NdJ("click",function(){return o.openDonationDialog()}),e._UZ(10,"mat-icon",9),e.TgZ(11,"span",10),e._uU(12,"Donate!"),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div",11),e.TgZ(14,"div",12),e.YNc(15,ce,2,2,"ng-container",13),e.ALo(16,"async"),e.YNc(17,ge,42,24,"ng-template",null,14,e.W1O),e.YNc(19,ue,2,0,"ng-template",null,15,e.W1O),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",o.isLoading),e.xp6(5),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",o.searchInputControl)("autocomplete","off")("placeholder","Search Order"),e.xp6(1),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(16,8,o.orders$)))},directives:[p.O5,d.KE,v.Hw,d.qo,Z.Nt,l.Fj,l.JJ,l.oH,_.lW,w.pW,h.YE,h.nU,T.NW,p.mk,p.sg,l._Y,l.JL,l.sg,l.x0,d.hX,l.u,U.Rr],pipes:[p.Ov,p.uU],styles:[".orders-grid{grid-template-columns:48px 50px 70px 70px 40px}@media (min-width: 600px){.orders-grid{grid-template-columns:48px auto 48px 48px 40px}}@media (min-width: 960px){.orders-grid{grid-template-columns:48px 112px auto 112px 72px}}@media (min-width: 1280px){.orders-grid{grid-template-columns:50px 150px 250px 150px 150px 150px 150px}}\n"],encapsulation:2,data:{animation:B.L},changeDetection:0}),n})();const _e=[{path:"",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-orders"]],decls:1,vars:0,template:function(t,o){1&t&&e._UZ(0,"router-outlet")},directives:[I.lC],encapsulation:2,changeDetection:0}),n})(),children:[{path:"",component:he,resolve:{orders:(()=>{class n{constructor(t){this._ordersService=t}resolve(t,o){return this._ordersService.getOrders()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(A))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()}}]}];var ve=s(6063),Ze=s(6005);let Te=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[D.su,Ze.Sr,I.Bz.forChild(_e),_.ot,Q.p9,d.lN,v.Ps,Z.c,N.Tx,T.TU,w.Cv,q.si,h.JX,L.LD,U.rP,S.AV,M.m,C.Is,x.FA,ve.Yd]]}),n})()}}]);